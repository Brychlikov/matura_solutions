import pandas as pd

malware = pd.read_csv('new_malware.txt', sep='\t', engine='c')
asn = pd.read_csv('new_asn.txt', sep='\t', engine='c').set_index('ASN')
kraje = pd.read_csv('new_kraje.txt', sep='\t', engine='c').set_index('ID_kraju')


all_things = malware.join(asn, on="ASN").join(kraje, on="ID_kraju")


print(all_things.dtypes)
print(all_things[all_things.apply(lambda d: 'phish' in d['opis'].lower(), axis=1)][['opis', 'kraj', 'URL']])

print('=====================')


print(
        all_things.groupby('ASN').count().sort_values(by='kraj', ascending=False)
        )
